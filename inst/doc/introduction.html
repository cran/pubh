<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Josie Athens" />

<meta name="date" content="2023-11-14" />

<title>Introduction to the pubh package</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to the pubh package</h1>
<h4 class="author">Josie Athens</h4>
<h4 class="date">2023-11-14</h4>



<div id="introduction" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<div id="rationale-for-the-package" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Rationale for the
package</h2>
<p>There has been a long relationship between the disciplines of
Epidemiology / Public Health and Biostatistics. Students frequently find
introductory textbooks explaining statistical methods and the maths
behind them, but how to implement those techniques in a computer is most
of the time not explained.</p>
<p>One of the most popular statistical software’s in public health
settings is <code>Stata</code>. <code>Stata</code> has the advantage of
offering a solid interface with functions that can be accessed via the
use of commands or by selecting the proper input in the graphical unit
interface (GUI). Furthermore, <code>Stata</code> offers <em>“Grad
Plans”</em> to postgraduate students, making it relatively affordable
from an economic point of view.</p>
<p><code>R</code> is a free alternative to <code>Stata</code>. The use
of <code>R</code> keeps growing; furthermore, with the relatively high
number of packages and textbooks available, it’s popularity is also
increasing.</p>
<p>In the case of epidemiology, there are already some good packages
available for <code>R</code>, including: <code>Epi</code>,
<code>epibasix</code>, <code>epiDisplay</code>, <code>epiR</code> and
<code>epitools</code>. The <code>pubh</code> package does not intend to
replace any of them, but to only provide a common syntax for the most
frequent statistical analysis in epidemiology.</p>
</div>
<div id="syntax-the-use-of-formulas" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Syntax: the use of
formulas</h2>
<p>Most students and professionals from the disciplines of Epidemiology
and Public Health analyse variables in terms of outcome, exposure and
confounders. The following table shows the most common names used in the
literature to characterise variables in a cause-effect
relationships:</p>
<table>
<thead>
<tr class="header">
<th><strong>Response variable</strong></th>
<th><strong>Explanatory variable(s)</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Outcome</td>
<td>Exposure and confounders</td>
</tr>
<tr class="even">
<td>Outcome</td>
<td>Predictors</td>
</tr>
<tr class="odd">
<td>Dependent variable</td>
<td>Independent variable(s)</td>
</tr>
<tr class="even">
<td>y</td>
<td>x</td>
</tr>
</tbody>
</table>
<p>In <code>R</code>, <code>formulas</code> are used to declare
relationships between variables. Formulas are common in classic
statistical tests and in regression methods.</p>
<p>Formulas have the following standard syntax:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>y <span class="sc">~</span> x, data <span class="ot">=</span> my_data</span></code></pre></div>
<p>Where <code>y</code> is the outcome or response variable,
<code>x</code> is the exposure or predictor of interest and
<code>my_data</code> specifies the name of the data frame where
<code>x</code> and <code>y</code> can be found.</p>
<p>The symbol <code>~</code> is used in <code>R</code> for formulas. It
can be interpreted as <em>depends on</em>. In the most typical scenario,
<code>y ~ x</code> means <code>y</code> depends on <code>x</code> or
<code>y</code> is a function of <code>x</code>:</p>
<p><code>y = f(x)</code></p>
<p>Using epidemiology friendly terms:</p>
<p><code>Outcome = f(Exposure)</code></p>
<p>Is worth to mention that <code>Stata</code> requires for variables to
be given in the same order as in formulas: outcome first, predictors
next.</p>
<p>The <code>pubh</code> package integrates well with other packages of
the <code>tidyverse</code> which use formulas and the pipe operator
<code>%&gt;%</code> to add layers over functions. In particular,
<code>pubh</code> uses <code>ggformula</code> as a graphical interface
for plotting and takes advantage of variable labels from
<code>sjlabelled</code>. This versatility allows it to interact also
with tables from <code>moonBook</code> and effect plots from
<code>sjPlot</code>.</p>
<div id="stratification" class="section level3" number="1.2.1">
<h3><span class="header-section-number">1.2.1</span> Stratification</h3>
<p>One way to control for confounders is the use of stratification. In
<code>Stata</code> stratification is done by including the
<code>by</code> option as part of the command. In the
<code>ggformula</code> package, one way of doing stratification is with
a formula like:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>y <span class="sc">~</span> x<span class="sc">|</span>z, data <span class="ot">=</span> my_data</span></code></pre></div>
<p>Where <code>y</code> is the outcome or response variable,
<code>x</code> is the exposure or predictor of interest, <code>z</code>
is the stratification variable (a factor) and <code>my_data</code>
specifies the name of the data frame where <code>x</code>,
<code>y</code> and <code>z</code> can be found.</p>
</div>
</div>
<div id="pipes-and-the-tidyverse" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Pipes and the
<code>tidyverse</code></h2>
<p>The <code>tidyverse</code> has become now the standard in data
manipulation in <code>R</code>. The use of the pipe function
<code>%&gt;%</code> from <code>magrittr</code> allows for cleaner code.
The principle of pipes is to change the paradigm in coding. In standard
codding, when many functions are used, one goes from inner parenthesis
to outer ones.</p>
<p>For example if we have three functions, a common syntax would look
like:</p>
<p><code>f3(f2(f1(..., data), ...), ...)</code></p>
<p>With pipes, however, the code reads top to bottom and left to
right:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="fu">f1</span>(...) <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="fu">f2</span>(...) <span class="sc">%&gt;%</span> </span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  <span class="fu">f3</span>(...)</span></code></pre></div>
<p>Most of the functions from <code>pubh</code> are compatible with
pipes and the <code>tidyverse</code>.</p>
</div>
<div id="contributions-of-the-pubh-package" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Contributions of the
<code>pubh</code> package</h2>
<p>The main contributions of the <code>pubh</code> package to students
and professionals from the disciplines of Epidemiology and Public Health
are:</p>
<ol style="list-style-type: decimal">
<li>Use of a common syntax for the most used analysis.</li>
<li>A function, <code>glm_coef</code> that displays coefficients from
most common regression analysis in a way that can be easy interpreted
and used for publications.</li>
<li>Integration with the <code>ggformula</code> package, introducing
plotting functions with a relatively simple syntax.</li>
<li>Integration with the most common epidemiological analysis, using the
standard formula syntax explained in the previous section.</li>
<li>Integration with the <code>gtsummary</code> and
<code>huxtable</code> packages. The <code>pubh</code> use huxtables as
standard as they can be easily exported to <em>html</em>, <em>pdf</em>
and <em>doc</em> files when <em>knitting</em>. Tables of descriptive
statistics and of regression coefficients are generated through
functions from <code>gtsummary</code> and then converted to
<code>huxtable</code> objects with convenient cosmetics.</li>
</ol>
</div>
</div>
<div id="descriptive-statistics" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Descriptive
statistics</h1>
<p>Many options currently exists for displaying descriptive statistics.
I recommend the function <code>tbl_summary</code> from the
<code>gtsummary</code> package for constructing tables of descriptive
statistics where results don’t need to be stratified.</p>
<p>In Public Health and Epidemiology it is common to be interested on
comparing cohorts, categorical variables considered as exposure of
interest. The most classic example are randomised control trials where
we want to compare treatment versus control cohorts. Package
<code>pubh</code> introduces the function <code>cross_tbl</code> as a
wrapper to <code>tbl_summary</code> from <code>gtsummary</code>. The
idea is to construct these tables, in a simple way and convert them to
huxtables.</p>
<p>The <code>estat</code> function from the <code>pubh</code> package
displays descriptive statistics of continuous outcomes; it can use
<em>labels</em> to display nice tables. As a way to aid in the
understanding of the variability, <code>estat</code> displays also the
relative dispersion (coefficient of variation) which is of particular
interest for comparing variances between groups (factors).</p>
<p>Some examples. We start by loading packages.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="fu">library</span>(jtools)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="fu">library</span>(pubh)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="fu">library</span>(sjlabelled)</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="fu">theme_set</span>(sjPlot<span class="sc">::</span><span class="fu">theme_sjplot2</span>(<span class="at">base_size =</span> <span class="dv">10</span>))</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="fu">theme_update</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="fu">options</span>(<span class="st">&#39;huxtable.knit_print_df&#39;</span> <span class="ot">=</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="fu">options</span>(<span class="st">&#39;huxtable.autoformat_number_format&#39;</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">numeric =</span> <span class="st">&quot;%5.2f&quot;</span>))</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">comment =</span> <span class="cn">NA</span>)</span></code></pre></div>
<p>We will use a data set about a study of onchocerciasis in Sierra
Leone.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">data</span>(Oncho)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>Oncho <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code># A tibble: 6 × 7
     id mf           area       agegrp sex    mfload lesions
  &lt;dbl&gt; &lt;fct&gt;        &lt;fct&gt;      &lt;fct&gt;  &lt;fct&gt;   &lt;dbl&gt; &lt;fct&gt;  
1     1 Infected     Savannah   20-39  Female      1 No     
2     2 Infected     Rainforest 40+    Male        3 No     
3     3 Infected     Savannah   40+    Female      1 No     
4     4 Not-infected Rainforest 20-39  Female      0 No     
5     5 Not-infected Savannah   40+    Female      0 No     
6     6 Not-infected Rainforest 20-39  Female      0 No     </code></pre>
<p>A two-by-two contingency table:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>Oncho <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>    <span class="at">mf =</span> <span class="fu">relevel</span>(mf, <span class="at">ref =</span> <span class="st">&quot;Infected&quot;</span>)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>  <span class="fu">copy_labels</span>(Oncho) <span class="sc">%&gt;%</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>  <span class="fu">select</span>(mf, area) <span class="sc">%&gt;%</span> </span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>  <span class="fu">cross_tbl</span>(<span class="at">by =</span> <span class="st">&quot;area&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>  <span class="fu">theme_pubh</span>(<span class="dv">2</span>)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-6">
<col><col><col><col><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;"></th><th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;"><p><strong>Residence</strong></p>
</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;"></th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;"></th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;"><p><strong>Savannah</strong>, N = 548</p>
</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;"><p><strong>Rainforest</strong>, N = 754</p>
</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;"><p><strong>Overall</strong>, N = 1,302</p>
</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;">Infection</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;"></td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 15pt; font-weight: normal;">Infected</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">281 (51%)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">541 (72%)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">822 (63%)</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3pt 6pt 3pt 15pt; font-weight: normal;">Not-infected</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">267 (49%)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">213 (28%)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">480 (37%)</td></tr>
</table>

<p>Table with all descriptive statistics except <code>id</code> and
<code>mfload</code>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>Oncho <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span> <span class="fu">c</span>(id, mfload)) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>    <span class="at">mf =</span> <span class="fu">relevel</span>(mf, <span class="at">ref =</span> <span class="st">&quot;Infected&quot;</span>)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>  <span class="fu">copy_labels</span>(Oncho) <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>  <span class="fu">cross_tbl</span>(<span class="at">by =</span> <span class="st">&quot;area&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>  <span class="fu">theme_pubh</span>(<span class="dv">2</span>)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-7">
<col><col><col><col><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;"></th><th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;"><p><strong>Residence</strong></p>
</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;"></th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;"></th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;"><p><strong>Savannah</strong>, N = 548</p>
</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;"><p><strong>Rainforest</strong>, N = 754</p>
</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;"><p><strong>Overall</strong>, N = 1,302</p>
</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;">Infection</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;"></td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 15pt; font-weight: normal;">Infected</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">281 (51%)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">541 (72%)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">822 (63%)</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 15pt; font-weight: normal;">Not-infected</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">267 (49%)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">213 (28%)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">480 (37%)</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;">Age group (years)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;"></td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 15pt; font-weight: normal;">5-9</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">93 (17%)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">109 (14%)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">202 (16%)</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 15pt; font-weight: normal;">10-19</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">72 (13%)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">146 (19%)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">218 (17%)</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 15pt; font-weight: normal;">20-39</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">208 (38%)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">216 (29%)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">424 (33%)</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 15pt; font-weight: normal;">40+</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">175 (32%)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">283 (38%)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">458 (35%)</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;">Sex</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;"></td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 15pt; font-weight: normal;">Male</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">247 (45%)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">369 (49%)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">616 (47%)</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 15pt; font-weight: normal;">Female</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">301 (55%)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">385 (51%)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">686 (53%)</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;">Severe eye lesions?</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">67 (12%)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">134 (18%)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">201 (15%)</td></tr>
</table>

<p>Next, we use a data set about blood counts of T cells from patients
in remission from Hodgkin’s disease or in remission from disseminated
malignancies. We generate the new variable <code>Ratio</code> and add
labels to the variables.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">data</span>(Hodgkin)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>Hodgkin <span class="ot">&lt;-</span> Hodgkin <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ratio =</span> CD4<span class="sc">/</span>CD8) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>  <span class="fu">var_labels</span>(</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>    <span class="at">Ratio =</span> <span class="st">&quot;CD4+ / CD8+ T-cells ratio&quot;</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>    )</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>Hodgkin <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code># A tibble: 6 × 4
    CD4   CD8 Group   Ratio
  &lt;int&gt; &lt;int&gt; &lt;fct&gt;   &lt;dbl&gt;
1   396   836 Hodgkin 0.474
2   568   978 Hodgkin 0.581
3  1212  1678 Hodgkin 0.722
4   171   212 Hodgkin 0.807
5   554   670 Hodgkin 0.827
6  1104  1335 Hodgkin 0.827</code></pre>
<p>Descriptive statistics for CD4+ T cells:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>Hodgkin <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  <span class="fu">estat</span>(<span class="sc">~</span> CD4) <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  <span class="fu">as_hux</span>() <span class="sc">%&gt;%</span> <span class="fu">theme_pubh</span>()</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-9">
<col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;"></th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">N</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Min.</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Max.</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Mean</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Median</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SD</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">CV</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">CD4+ T-cells</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">40.00</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">116.00</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">2415.00</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">672.62</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">528.50</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">470.49</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"> 0.70</td></tr>
</table>

<p>In the previous code, the left-hand side of the formula is empty as
it’s the case when working with only one variable.</p>
<p>For stratification, <code>estat</code> recognises the following two
syntaxes:</p>
<ul>
<li><code>outcome ~ exposure</code></li>
<li><code>~ outcome | exposure</code></li>
</ul>
<p>where, <code>outcome</code> is continuous and <code>exposure</code>
is a categorical (<code>factor</code>) variable.</p>
<p>For example:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>Hodgkin <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  <span class="fu">estat</span>(<span class="sc">~</span> Ratio<span class="sc">|</span>Group) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  <span class="fu">as_hux</span>() <span class="sc">%&gt;%</span> <span class="fu">theme_pubh</span>()</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-10">
<col><col><col><col><col><col><col><col><col><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;"></th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Disease</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">N</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Min.</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Max.</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Mean</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Median</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">SD</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">CV</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">CD4+ / CD8+ T-cells ratio</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Non-Hodgkin</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">20.00</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"> 1.10</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"> 3.49</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"> 2.12</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"> 2.15</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"> 0.73</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"> 0.34</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Hodgkin</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">20.00</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"> 0.47</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"> 3.82</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"> 1.50</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"> 1.19</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"> 0.91</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"> 0.61</td></tr>
</table>

<p>As before, we can report a table of descriptive statistics for all
variables in the data set:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>Hodgkin <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>    <span class="at">Group =</span> <span class="fu">relevel</span>(Group, <span class="at">ref =</span> <span class="st">&quot;Hodgkin&quot;</span>)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>  <span class="fu">copy_labels</span>(Hodgkin) <span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>  <span class="fu">cross_tbl</span>(<span class="at">by =</span> <span class="st">&quot;Group&quot;</span>, <span class="at">bold =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>  <span class="fu">theme_pubh</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>  <span class="fu">add_footnote</span>(<span class="st">&quot;Median (IQR)&quot;</span>, <span class="at">font_size =</span> <span class="dv">9</span>)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-11">
<col><col><col><col><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;"></th><th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;"><p><strong>Disease</strong></p>
</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;"></th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;"></th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;"><p><strong>Hodgkin</strong>, N = 20</p>
</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;"><p><strong>Non-Hodgkin</strong>, N = 20</p>
</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;"><p><strong>Overall</strong>, N = 40</p>
</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">CD4+ T-cells</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">682 (397, 1,131)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">433 (360, 709)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">529 (375, 916)</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">CD8+ T-cells</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">448 (305, 817)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">232 (150, 323)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">319 (209, 588)</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">CD4+ / CD8+ T-cells ratio</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">1.19 (0.83, 2.00)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">2.15 (1.58, 2.68)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">1.70 (1.13, 2.30)</td></tr>
<tr>
<td colspan="4" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal; font-size: 9pt;">Median (IQR)</td></tr>
</table>

<div id="inferential-statistics" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Inferential
statistics</h2>
<p>From the descriptive statistics of <em>Ratio</em> we know that the
relative dispersion in the Hodgkin group is almost as double as the
relative dispersion in the Non-Hodgkin group.</p>
<p>For new users of <code>R</code> it helps to have a common syntax in
most of the commands, as <code>R</code> could be challenging and even
intimidating at times. We can test if the difference in variance is
statistically significant with the <code>var.test</code> command, which
uses can use a formula syntax:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">var.test</span>(Ratio <span class="sc">~</span> Group, <span class="at">data =</span> Hodgkin)</span></code></pre></div>
<pre><code>
    F test to compare two variances

data:  Ratio by Group
F = 0.6294, num df = 19, denom df = 19, p-value = 0.3214
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.2491238 1.5901459
sample estimates:
ratio of variances 
         0.6293991 </code></pre>
<p>What about normality? We can look at the QQ-plots against the
standard Normal distribution.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>Hodgkin <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>  <span class="fu">qq_plot</span>(<span class="sc">~</span> Ratio<span class="sc">|</span>Group) </span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Let’s say we choose a non-parametric test to compare the groups:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(Ratio <span class="sc">~</span> Group, <span class="at">data =</span> Hodgkin)</span></code></pre></div>
<pre><code>
    Wilcoxon rank sum exact test

data:  Ratio by Group
W = 298, p-value = 0.007331
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div id="graphical-output" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Graphical output</h2>
<p>For relatively small samples (for example, less than 30 observations
per group) is a standard practice to show the actual data in dot plots
with error bars. The <code>pubh</code> package offers two options to
show graphically differences in continuous outcomes among groups:</p>
<ul>
<li>For small samples: <code>strip_error</code></li>
<li>For medium to large samples: <code>bar_error</code></li>
</ul>
<p>For our current example:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>Hodgkin <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>  <span class="fu">strip_error</span>(Ratio <span class="sc">~</span> Group)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The error bars represent 95% confidence intervals around mean
values.</p>
<p>Is relatively easy to add a line on top, to show that the two groups
are significantly different. The function <code>gf_star</code> needs the
reference point on how to draw an horizontal line to display statistical
difference or to annotate a plot; in summary, <code>gf_star</code>:</p>
<ul>
<li>Draws an horizontal line from <span class="math inline">\((x1,
y2)\)</span> to <span class="math inline">\((x2, y2)\)</span>.</li>
<li>Draws a vertical line from <span class="math inline">\((x1,
y1)\)</span> to <span class="math inline">\((x1, y1)\)</span>.</li>
<li>Draws a vertical line from <span class="math inline">\((x2,
y1)\)</span> to <span class="math inline">\((x2, y1)\)</span>.</li>
<li>Writes a character (the legend or “star”) at the mid point between
<span class="math inline">\(x1\)</span> and <span class="math inline">\(x2\)</span> at high <span class="math inline">\(y3\)</span>.</li>
</ul>
<p>Thus:</p>
<p><span class="math display">\[
y1 &lt; y2 &lt; y3
\]</span></p>
<p>In our current example:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>Hodgkin <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>  <span class="fu">strip_error</span>(Ratio <span class="sc">~</span> Group) <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>  <span class="fu">gf_star</span>(<span class="at">x1 =</span> <span class="dv">1</span>, <span class="at">y1 =</span> <span class="dv">4</span>, <span class="at">x2 =</span> <span class="dv">2</span>, <span class="at">y2 =</span> <span class="fl">4.05</span>, <span class="at">y3 =</span> <span class="fl">4.1</span>, <span class="st">&quot;**&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>For larger samples we could use bar charts with error bars. For
example:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">data</span>(birthwt, <span class="at">package =</span> <span class="st">&quot;MASS&quot;</span>)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>birthwt <span class="ot">&lt;-</span> birthwt <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>    <span class="at">smoke =</span> <span class="fu">factor</span>(smoke, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Non-smoker&quot;</span>, <span class="st">&quot;Smoker&quot;</span>)),</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>    <span class="at">Race =</span> <span class="fu">factor</span>(race <span class="sc">&gt;</span> <span class="dv">1</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;White&quot;</span>, <span class="st">&quot;Non-white&quot;</span>)),</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>    <span class="at">race =</span> <span class="fu">factor</span>(race, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;White&quot;</span>, <span class="st">&quot;Afican American&quot;</span>, <span class="st">&quot;Other&quot;</span>))</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>  <span class="fu">var_labels</span>(</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>    <span class="at">bwt =</span> <span class="st">&#39;Birth weight (g)&#39;</span>,</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>    <span class="at">smoke =</span> <span class="st">&#39;Smoking status&#39;</span>,</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>    <span class="at">race =</span> <span class="st">&#39;Race&#39;</span>,</span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>birthwt <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>  <span class="fu">bar_error</span>(bwt <span class="sc">~</span> smoke)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Quick normality check:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>birthwt <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>  <span class="fu">qq_plot</span>(<span class="sc">~</span> bwt<span class="sc">|</span>smoke)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The (unadjusted) <span class="math inline">\(t\)</span>-test:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>birthwt <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>  <span class="fu">t_test</span>(bwt <span class="sc">~</span> smoke, <span class="at">detailed =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span></code></pre></div>
<pre><code>  estimate estimate1 estimate2 .y.     group1 group2  n1 n2 statistic     p
1 283.7767  3055.696  2771.919 bwt Non-smoker Smoker 115 74  2.729886 0.007
        df conf.low conf.high method alternative
1 170.1002 78.57486  488.9786 T-test   two.sided</code></pre>
<p>The final plot with annotation to highlight statistical difference
(unadjusted):</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>birthwt <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>  <span class="fu">bar_error</span>(bwt <span class="sc">~</span> smoke) <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>  <span class="fu">gf_star</span>(<span class="at">x1 =</span> <span class="dv">1</span>, <span class="at">x2 =</span> <span class="dv">2</span>, <span class="at">y1 =</span> <span class="dv">3400</span>, <span class="at">y2 =</span> <span class="dv">3500</span>, <span class="at">y3 =</span> <span class="dv">3550</span>, <span class="st">&quot;**&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Both <code>strip_error</code> and <code>bar_error</code> can generate
plots stratified by a third variable, for example:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>birthwt <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>  <span class="fu">bar_error</span>(bwt <span class="sc">~</span> smoke, <span class="at">fill =</span> <span class="sc">~</span> Race) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>  <span class="fu">gf_refine</span>(ggsci<span class="sc">::</span><span class="fu">scale_fill_jama</span>()) </span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>birthwt <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>  <span class="fu">bar_error</span>(bwt <span class="sc">~</span> smoke<span class="sc">|</span>Race)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>birthwt <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>  <span class="fu">strip_error</span>(bwt <span class="sc">~</span> smoke, <span class="at">pch =</span> <span class="sc">~</span> Race, <span class="at">col =</span> <span class="sc">~</span> Race) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>  <span class="fu">gf_refine</span>(ggsci<span class="sc">::</span><span class="fu">scale_color_jama</span>())</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="regression-models" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Regression models</h1>
<p>The <code>pubh</code> package includes the function
<code>cosm_reg</code>, which adds some cosmetics to objects generated by
<code>tbl_regression</code> and <code>huxtable</code>. The function
<code>multiple</code> helps in the analysis and visualisation of
multiple comparisons.</p>
<p>For simplicity, here we show the analysis of the linear model of
smoking on birth weight, adjusting by race (and not by other potential
confounders).</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>model_bwt <span class="ot">&lt;-</span> <span class="fu">lm</span>(bwt <span class="sc">~</span> smoke <span class="sc">+</span> race, <span class="at">data =</span> birthwt)</span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>model_bwt <span class="sc">%&gt;%</span> </span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>  <span class="fu">tbl_regression</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>  <span class="fu">cosm_reg</span>() <span class="sc">%&gt;%</span> <span class="fu">theme_pubh</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>  <span class="fu">add_footnote</span>(<span class="fu">get_r2</span>(model_bwt), <span class="at">font_size =</span> <span class="dv">9</span>)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-26">
<col><col><col><col><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;"><p><strong>Variable</strong></p>
</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;"><p><strong>Beta</strong></p>
</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;"><p><strong>95% CI</strong></p>
</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;"><p><strong>p-value</strong></p>
</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;">Smoking status</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">&lt;0.001</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 15pt; font-weight: normal;">Non-smoker</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">—</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">—</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;"></td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 15pt; font-weight: normal;">Smoker</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">-429</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">-644, -214</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;"></td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;">Race</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">&lt;0.001</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 15pt; font-weight: normal;">White</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">—</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">—</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;"></td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 15pt; font-weight: normal;">Afican American</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">-450</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">-752, -148</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;"></td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 3pt 6pt 3pt 15pt; font-weight: normal;">Other</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">-453</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">-683, -223</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;"></td></tr>
<tr>
<td colspan="4" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal; font-size: 9pt;">R2 = 0.123</td></tr>
</table>

<p>Similar results can be obtained with the function
<code>glm_coef</code>.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>model_bwt <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>  <span class="fu">glm_coef</span>(<span class="at">labels =</span> <span class="fu">model_labels</span>(model_bwt)) <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>  <span class="fu">as_hux</span>() <span class="sc">%&gt;%</span> <span class="fu">theme_pubh</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>  <span class="fu">set_align</span>(everywhere, <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="st">&quot;right&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>  <span class="fu">add_footnote</span>(<span class="fu">get_r2</span>(model_bwt), <span class="at">font_size =</span> <span class="dv">9</span>)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-27">
<col><col><col><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Parameter</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Coefficient</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Pr(&gt;|t|)</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Constant</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3334.95 (3153.89, 3516.01)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&lt; 0.001</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Smoking status: Smoker</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-428.73 (-643.86, -213.6)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&lt; 0.001</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Race: Afican American</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-450.36 (-752.45, -148.27)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.004</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Race: Other</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-452.88 (-682.67, -223.08)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&lt; 0.001</td></tr>
<tr>
<td colspan="3" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal; font-size: 9pt;">R2 = 0.123</td></tr>
</table>

<p>In the last table of coefficients confidence intervals and p-values
for levels of race are not adjusted for multiple comparisons. We can use
functions from the <code>emmeans</code> package to make the
corrections.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="fu">multiple</span>(model_bwt, <span class="sc">~</span> race)<span class="sc">$</span>df</span></code></pre></div>
<pre><code>                 contrast estimate     SE t.ratio p.value lower.CL upper.CL
1 Afican American - White  -450.36 153.12   -2.94    0.01  -810.74   -89.97
2           Other - White  -452.88 116.48   -3.89 &lt; 0.001  -727.02  -178.74
3 Other - Afican American    -2.52 160.59   -0.02       1  -380.49   375.46</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="fu">multiple</span>(model_bwt, <span class="sc">~</span> race)<span class="sc">$</span>fig_ci <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>  <span class="fu">gf_labs</span>(<span class="at">x =</span> <span class="st">&quot;Difference in birth weights (g)&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeAAAAGACAMAAABC/kH9AAACzVBMVEUAAAAAADoAAGYAOpAAZmYAZpAAZrYTK0MTLEQULUYULkcVL0gWMEoWMUsXMk0XM04YNE8YNVEZGUgZGXEZNlIZN1QZSEgZSJcZcXEZcZcZcboaGhoaOFUaOVYbO1gbO1kcPVscPVwdP10eQF8eQWAfQmIfQ2QgRGUgRWYhRmghR2kiSWsiSmwjS24kTG8kTXElTnIlT3QmUHUmUXYnUngoVHooVXspVn0pV34qWIAqWYIrWoMsXIUsXYYtXoctX4kuYIouYYwvY44wZI8wZZExZpIxZ5QyaZYyaZczMzMzM38za5kzf8E0bJo0bZw1bp41b582caE3cqI3c6Q4dKY4dac5d6k6AAA6ADo6AGY6Ojo6OmY6OpA6ZrY6eKs6eaw6kNs7eq47e688fbE9frM9f7Q+gLY+gbc/g7lAhLtAhbxBhr5Bh79CicFDisNDi8REjcZEjshFj8lGkMtGkc1Hk89IGRlIGUhIGXFISHFISJdIcXFIcZdIcbpIlNBIldJIl7pIl91Jl9RJmNVKmddLm9lLm9pMndxNnt1Nn99OoeFOouNPo+VQpOZQpuhRp+pSqOtSqu1Tq+5UrPBUrvJVr/RWsPZWsfdaM1paM39aoOFmAABmADpmAGZmOgBmZmZmkJBmtv9xGRlxGUhxGXFxSBlxSEhxSJdxcXFxl5dxl91xurpxuv9/MzN/M1p/M39/f39/wf+QOgCQOjqQOmaQZgCQkDqQkGaQtpCQ29uQ2/+XSBmXSEiXSHGXcXGXl3GXupeX3d2X3f+gWjOgWn+g4f+2ZgC2Zjq2tma225C2/7a2//+6cRm6cUi6unG63Ze6/926///BfzPB/8HB///NXFzbkDrb///dl0jdunHdurrd3Zfd/7rd/93d///hoFrr6+v/tmb/unH/wX//25D/3Zf/3d3/4aD//7b//7r//8H//9v//93//+H///+wUK+EAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAOvklEQVR4nO2d958bRxmHLwn46OUOUNDSe++9HR0MoRdjQuDovYMvVmJi0XsHA4kDJ9s5kiwQQrfsQAQYyMlJFLCjIKM4wktOiTJ/A1N2VytZK83l3tvRjL7P56xb7853XlmPZva98w+aYsBppkw/AbC+QLDjQLDjQLDjQLDjQLDjQLDjQLDjQLDjQLDjQLDjQLDjQPBQpm9169vc9na3v8Md73Tnu9z1Huxe977Pfe93/wc88EEPfshDH/bwRzzyUY9+zGMf9/gnPPFJT37KU5/29Gc881ns2c957vOe/4IXvujFL33Zy1/xyle9+jWvfd3r3/yWt77t7e9457ve/Z73vo994IMf+vBHPvqxj3/ik58669Of+eznPv+FL37py1/56te+/o1vfuvb3/nu975P/C+A4KFAsONAsONAsOP0Cr7nSMFzowS/H4LHCgh2HAh2HAh2HAh2HAh2HAh2HAh2HAh2HAh2HAh2HAh2HAgeZ4LTa4PPdcre7PGXBgUheJwZILhdEmarefGlE8R/F44zxwuue2fwc+1dlYGre0AQgscZ4SnY4s1UmPh297LP/t2U50LJis6+P3peXpzrlP2Wx48h2BK4p3bJZ61Z+a3u+SyU3iu4LK5v5/qDwhExfKYCwXbAPYUuW7kmE5IHC+bn6/l6ntWL4u/8CgTbAfckzHKDdfWNpQpu5RqF/+yriK3cS65g+3Fc8MAV3NtkhSuYHfxToRksVHpXsP04LnjgPbj3x6ROOdeUw7yiGMqqWMG20NtFnyw3ZemuXUr8oqNT/qnH3bL2btFHex5vtyDYRrp33V7UvdlZJkOwuLe2Un47CcEuUPfkTp1ENMycmUshGFgMBK+CqzZu/OXQATf9eePGU4bPccMv/kX4jEYDwfr895RReq49hTse+h644WcvgeAxRmP9XfujIRdv+ss/sYLHmGtHbNFs9FsAW/R4c9UIwzf8/K8jBkDwWHJV2D2lb8ByxPU/SPerpoDg8YU3WSNW8PU/HGkPgscYvgaHdVBywKghEAxIgWDHgWDHgWDHgWDHgWDHgWDHgWDHgWDHgWDHgWDHgWDHgWDHgWDHgWDHgWDHgWDHgWDHgWDHgWDHgWDHGUfBFw29enRtk68tbjJ98+IQbE0agrUwqejQmtIQrAUEmweCCYtDcIZpCFY4KxhNlgKCCeMQbE0agrWAYPM4KxhNlgKCCYtDcIZpCFZAMGFxCLYmDcFaQLB5IJgwDsHWpCFYCzRZ5oFgwuIQnGEaghUQTFgcgq1JQ7AWEGweCCaMQ7A1aQjWAk2WeSCYsDgEZ5iGYAUEExaHYGvSEKwFBJsHggnjEGxNGoK1QJNlHggmLA7BGaYhWAHBhMUh2Jo0BGsBweaBYMI4BFuThmAt0GSZB4IJi0NwhmkIVkAwYXEItiYNwVpA8JrolD0vz1h7qRkUmiljqj7/k2uyoNCQY4LCkaWesRBMGKcV3CkXubw8dzZEcL3I3wCX1Pj3aEzf2IwET09PryG9ttrZxWkFS1Pt3VeWvVxj6x6xlltiRQdb98zWuoO2seCCus8OVgI5RjzmmnKgIhvB09M3w/CkN1kt4aizryJW8EKlvbsmjFd9fpwYxE/X/VZRXA3HNNSCF3u34KKjo5keFzSea8yh1QxeK+suuNDkB3xdel6xbws+eOn+WnupsY2pMVKwGhgKHloDK3hVrMsWXesKzsen+c053IXrFy41O/svL/YIzndncfYebL/g3iZLyFuodMp+3woOzuOj6jOVpGA1UF1HF00YX6cfk0q5hpQXNlm9gtslbrLF265I8JGSgSbLuvRYCCYBggnjEGxNGoK1wH82mAeCCYtDcIZpCFZAMGFxCLYmDcFaQLB5IJgwDsHWpCFYCzRZ5oFgwuIQnGEaghUQTFgcgq1JQ7AWEGweCCaMQ7A1aQjWAk2WeSCYsDgEZ5iGYAUEExaHYGvSEKwFBJsHggnjEGxNGoK1QJNlHggmLA7BGaYhWAHBhMUh2Jo0BGsBweaBYMI4BFuThmAt0GSZB4IJi0NwhmkIVkAwYXEItiYNwVpAsHkgmDAOwdakIVgLNFnmgWDC4hCcYRqCFRBMWByCrUlDsBYQbB4IJoxDsDVpCNYCTZZ5IJiwOARnmIZgBQQTFodga9IQrAUEmweCCeMQbE0agrVAk2UeCCYsDsEZpiFYAcGExSHYmjQEawHB5oFgwjgEW5OGYC3QZJkHggmLQ3CGaQhWQDBhcQi2Jg3BWkCweSCYMA7B1qQhWAs0WeaBYMLiqYI7Zc/LM9ZeagaFZnq+WgwHn586Sg05jvRpIZiweJrgTplrqeaFhmGCgzP319gwWfGQVeCq4B2HdmRfPE2wVNbefWXZyzW27hFruSVWdLB1z2xSV9Wv+3xcyZu9gr8Ttnj8Yl2OO6MkMt0hPOhtL3vF7jSpAVcF7xBkXjxNcEu82p19FbGCFyrt3TVhvOrz4+So8Lxa50d2VVg9zw/F2dNr/DExhAfFV6ERT5MW4IKPGmOHxfT9U1YhuNDkB3zleV6xby+ui33cDwU31DW+LGcqKpMYouYJCtfE06QFsIJJi4/Yomtdwfn4NDcmGzCxNXNyzaTg1mytvavrKxoSC46nSQkwZwWzNfpdzyZLLOWFSqfs967gaJl3t+hWjhtsJRZk707ApcbTpASYu4LHqouOf0wq5RrqtVfdUVJwR7XHrehtIHsmvmRPLvmRr3hIJLgZTzM4IIBgwuL4RUeGaQhWQDBhcQi2Jg3BWkCweSCYMA7B1qQhWAs0WeaBYMLiEJxhGoIVEExYHIKtSUOwFhBsHggmjEOwNWkI1gJNlnkgmLA4BGeYhmAFBBMWh2Br0hCsBQSbB4IJ4xBsTRqCtUCTZR4IJiwOwRmmIVgBwYTFIdiaNARrAcHmgWDCOARbk4ZgLdBkmQeCCYtDcIZpCFZAMGFxCLYmDcFaQLB5IJgwDsHWpCFYCzRZ5oFgwuIQnGEaghUQTFgcgq1JQ7AWEGweCCaMQ7A1aQjWAk2WeSCYsDgEZ5iGYAUEExaHYGvSEKwFBJsHggnjEGxNGoK1QJNlHggmLA7BGaYhWAHBhMUh2Jo0BGsBweaBYMI4BFuThmAt0GSZB4IJi0NwhmkIVkAwYXEItiYNwVpAsHkgmDAOwdakIVgLNFnmgWDC4hCcYRqCFRBMWByCrUlDsBYQbB4IJowPEVwtisdO2Tu/0Bw65DiC1IAM+fxPrslHNeS4oHBkqWd8VoLn5ubWkF5b7czi6YKDM/fX2HBZ4ZBVUi+y9tIlNf49mruvRkaC5+ZWb9ilJqvq1/lSa5e82SsKzWCLN8uVeF6eBWeU+GNiSLB1j7e97BVZS17euic9IAm2seACHjxYEUmZ8HJNGVZcdLSHOQs5OpBDg0+vD6MEt3fX5MLiD3wP3VVh9Tw/FGdPr/HHxJBgoSK+5IZb9fkhSwvEM9f9VlFcWajIORqiRlPu3VLw0LckVvCqSBXMN1L5ikvB6mbJ+LKc4SabnX2VxBA5gn9d43HktpsWCDl46f5ae6mxjakrcnRLhtV1Z+/B4ySYb80c2QrFgluztfaurq9oSCxYbrFJwX2BargL1y9canb2X17sEZzYxNFFE8bTBMsXXHiJt+hWjhtsJRZkNCQS3FiodMq+EjwwEBGcx5dqfaaSFBzIsLoOwYTxFMEd1R5zh6E+0TPxJXtyyY98xUMiwapPUoIHBWLaJV+u7ljwkVJvk0X/z6SKOyPYKBBMGIfgDNPj1GSZBIIJi0NwhmkIVkAwYXEItiYNwVpAsHkgmDAOwdakIVgLNFnmgWDC4hCcYRqCFRBMWByCrUlDsBYQbB4IJoxDsDVpCNYCTZZ5IJiwOARnmIZgBQQTFodga9IQrAUEmweCCeMQbE0agrVAk2UeCCYsDsEZpiFYAcGExSHYmjQEawHB5oFgwjgEW5OGYC3QZJkHggmLQ3CGaQhWQDBhcQi2Jg3BWkCweSCYMA7B1qQhWAs0WeaBYMLiEJxhGoIVEExYfCwFAwLCF3McBQNCINhxINhxINhxINhxINhxINhxJkhw1ROfttfyPPGZL/IxW0zUnCTB4ad57aqIj9qTj9nWN1GTTZJg9epGH9XU91FOWdQ3UJNNkuDW3bZ4eflxbVVfPWZc30BNNkmC2f+arO5DsJPEH4tZxBbtLGIF1X00We5SlR9QjB+TgFNAsONAsONAsONAsONAsONMgOBjm6Y48/xg8zI7MHXSb6ZOulo/zDNdbrx4se9k7/WUaNqgw/PRgNO0n9BqmQTB4uVdOVu+mCvn7OVfN3uqUHBi4iGC+57B8Z5XdsZ/P7DI1olJEcyuO3FZHWspSYFWcLyA+bNbxaayOiZGMF+4xzb/Q+7WU4srZ09x38dOPffE5fBw82/VLs4HLIr1PnXichSOrjEh+MfiUJw89Vw+0Ql8zr/LhJJ/bNOicBXNuSzmu+XFi2oQP3vCXnadSKnJfrWXhQPYWraV4UyM4BvF67ysvoSLwyddLXTEh/Nija+cvci618NweI3JSYQ9OdGmxdDghujiYX70xnm+LqM5N8v5Dk8thoPEeGHyunhqFg7o2xoomUjB4St97A17We9h8qVXa0qMDoexcIs+sCFxMnHx2Juu/tvvT1N11IYh5xNvCDUoMhoi3hfhAD7p/IBnTsHECFavePi1Kdxel1nycPNytGzVyTCcuNVKwYc3JE4mLq6c84dfX7bzsp2J6cV8ofHo7s83arWlS7nhAAheC3GT1bOCWU+TFB4mVnA33C/4wPxgwezAT/ga/t2GxJzRCk4IZlG/J4dhBRMQ/5jUcw8OX/DEYXjP5PtpeDIM9wiWd+7oZLRNR+LEHZj/6c4Z3YNDwWI8/5MQjHswAeoXHYusK5iphjbaMk/oeup20WGr2y847qLlmyN2FxbiPbTIJebcNHWLc6IbgBif7KKFVDUAXbTFpLsLfw5ONNbrAASvJ4kNeQArO5ejAfhNlqUcjjfkgVfnwwH8J6z1egYQ7DgQ7DgQ7DgQ7DgQ7DgQ7Dj/B0L9MdTqjXkpAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="fu">multiple</span>(model_bwt, <span class="sc">~</span> race)<span class="sc">$</span>fig_pval <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>  <span class="fu">gf_labs</span>(<span class="at">y =</span> <span class="st">&quot; &quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="epidemiology-functions" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Epidemiology
functions</h1>
<p>The <code>pubh</code> package offers two wrappers to
<code>epiR</code> functions.</p>
<ol style="list-style-type: decimal">
<li><code>contingency</code> calls <code>epi.2by2</code> and it’s used
to analyse two by two contingency tables.</li>
<li><code>diag_test</code> calls <code>epi.tests</code> to compute
statistics related with screening tests.</li>
</ol>
<div id="contingency-tables" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Contingency
tables</h2>
<p>Let’s say we want to look at the effect of ibuprofen on preventing
death in patients with sepsis.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="fu">data</span>(Bernard)</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>Bernard <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code># A tibble: 6 × 9
     id treat     race             fate  apache o2del followup temp0 temp10
  &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt;            &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1     1 Placebo   White            Dead      27  539.       50  35.2   36.6
2     2 Ibuprofen African American Alive     14   NA       720  38.7   37.6
3     3 Placebo   African American Dead      33  551.       33  38.3   NA  
4     4 Ibuprofen White            Alive      3 1376.      720  38.3   36.4
5     5 Placebo   White            Alive      5   NA       720  38.6   37.6
6     6 Ibuprofen White            Alive     13 1523.      720  38.2   38.2</code></pre>
<p>Let’s look at the table:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a>Bernard <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>    <span class="at">fate =</span> <span class="fu">relevel</span>(fate, <span class="at">ref =</span> <span class="st">&quot;Dead&quot;</span>),</span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>    <span class="at">treat =</span> <span class="fu">relevel</span>(treat, <span class="at">ref =</span> <span class="st">&quot;Ibuprofen&quot;</span>)</span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a>  <span class="fu">copy_labels</span>(Bernard) <span class="sc">%&gt;%</span></span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a>  <span class="fu">select</span>(fate, treat) <span class="sc">%&gt;%</span> </span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a>  <span class="fu">cross_tbl</span>(<span class="at">by =</span> <span class="st">&quot;treat&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a>  <span class="fu">theme_pubh</span>(<span class="dv">2</span>)</span></code></pre></div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-32">
<col><col><col><col><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;"></th><th colspan="2" style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;"><p><strong>Treatment</strong></p>
</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;"></th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;"></th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;"><p><strong>Ibuprofen</strong>, N = 224</p>
</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;"><p><strong>Placebo</strong>, N = 231</p>
</th><th style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;"><p><strong>Overall</strong>, N = 455</p>
</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: bold;">Mortality status</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;"></td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;"></td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 15pt; font-weight: normal;">Dead</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">84 (38%)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">92 (40%)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">176 (39%)</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3pt 6pt 3pt 15pt; font-weight: normal;">Alive</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">140 (63%)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">139 (60%)</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 3pt 6pt 3pt 6pt; font-weight: normal;">279 (61%)</td></tr>
</table>

<p>For <code>epi.2by2</code> we need to provide the table of counts in
the correct order, so we would type something like:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">84</span>, <span class="dv">140</span> , <span class="dv">92</span>, <span class="dv">139</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a>epiR<span class="sc">::</span><span class="fu">epi.2by2</span>(<span class="fu">as.table</span>(dat))</span></code></pre></div>
<pre><code>             Outcome +    Outcome -      Total                 Inc risk *
Exposed +           84          140        224     37.50 (31.14 to 44.20)
Exposed -           92          139        231     39.83 (33.46 to 46.45)
Total              176          279        455     38.68 (34.18 to 43.33)

Point estimates and 95% CIs:
-------------------------------------------------------------------
Inc risk ratio                                 0.94 (0.75, 1.19)
Inc odds ratio                                 0.91 (0.62, 1.32)
Attrib risk in the exposed *                   -2.33 (-11.27, 6.62)
Attrib fraction in the exposed (%)            -6.20 (-33.90, 15.76)
Attrib risk in the population *                -1.15 (-8.88, 6.59)
Attrib fraction in the population (%)         -2.96 (-15.01, 7.82)
-------------------------------------------------------------------
Uncorrected chi2 test that OR = 1: chi2(1) = 0.260 Pr&gt;chi2 = 0.610
Fisher exact test that OR = 1: Pr&gt;chi2 = 0.631
 Wald confidence limits
 CI: confidence interval
 * Outcomes per 100 population units </code></pre>
<p>For <code>contingency</code> we only need to provide the information
in a formula:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a>Bernard <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a>  <span class="fu">contingency</span>(fate <span class="sc">~</span> treat) </span></code></pre></div>
<pre><code>           Outcome
Predictor   Dead Alive
  Ibuprofen   84   140
  Placebo     92   139

             Outcome +    Outcome -      Total                 Inc risk *
Exposed +           84          140        224     37.50 (31.14 to 44.20)
Exposed -           92          139        231     39.83 (33.46 to 46.45)
Total              176          279        455     38.68 (34.18 to 43.33)

Point estimates and 95% CIs:
-------------------------------------------------------------------
Inc risk ratio                                 0.94 (0.75, 1.19)
Inc odds ratio                                 0.91 (0.62, 1.32)
Attrib risk in the exposed *                   -2.33 (-11.27, 6.62)
Attrib fraction in the exposed (%)            -6.20 (-33.90, 15.76)
Attrib risk in the population *                -1.15 (-8.88, 6.59)
Attrib fraction in the population (%)         -2.96 (-15.01, 7.82)
-------------------------------------------------------------------
Uncorrected chi2 test that OR = 1: chi2(1) = 0.260 Pr&gt;chi2 = 0.610
Fisher exact test that OR = 1: Pr&gt;chi2 = 0.631
 Wald confidence limits
 CI: confidence interval
 * Outcomes per 100 population units 


    Pearson&#39;s Chi-squared test with Yates&#39; continuity correction

data:  dat
X-squared = 0.17076, df = 1, p-value = 0.6794</code></pre>
<p>Advantages of <code>contingency</code>:</p>
<ol style="list-style-type: decimal">
<li>Easier input without the need to create the table.</li>
<li>Displays the standard epidemiological table at the start of the
output. This aids to check what are the reference levels on each
category.</li>
<li>In the case that the <span class="math inline">\(\chi^2\)</span>-test is not appropriate,
<code>contingency</code> would show the results of the Fisher exact test
at the end of the output.</li>
</ol>
<div id="mantel-haenszel-odds-ratio" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Mantel-Haenszel
odds ratio</h3>
<p>For <code>mhor</code> the formula has the following syntax:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a>outcome <span class="sc">~</span> stratum<span class="sc">/</span>exposure, data <span class="ot">=</span> my_data</span></code></pre></div>
<p>Thus, <code>mhor</code> displays the odds ratio of <em>exposure
yes</em> against <em>exposure no</em> on <em>outcome yes</em> for
different levels of <em>stratum</em>, as well as the Mantel-Haenszel
pooled odds ratio.</p>
<p>Example: effect of eating chocolate ice cream on being ill by sex
from the <code>oswego</code> data set.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="fu">data</span>(oswego, <span class="at">package =</span> <span class="st">&quot;epitools&quot;</span>)</span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a>oswego <span class="ot">&lt;-</span> oswego <span class="sc">%&gt;%</span></span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a>    <span class="at">ill =</span> <span class="fu">factor</span>(ill, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>)),</span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a>    <span class="at">sex =</span> <span class="fu">factor</span>(sex, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Male&quot;</span>)),</span>
<span id="cb45-7"><a href="#cb45-7" tabindex="-1"></a>    <span class="at">chocolate.ice.cream =</span> <span class="fu">factor</span>(chocolate.ice.cream, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>))</span>
<span id="cb45-8"><a href="#cb45-8" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb45-9"><a href="#cb45-9" tabindex="-1"></a>  <span class="fu">var_labels</span>(</span>
<span id="cb45-10"><a href="#cb45-10" tabindex="-1"></a>    <span class="at">ill =</span> <span class="st">&quot;Developed illness&quot;</span>,</span>
<span id="cb45-11"><a href="#cb45-11" tabindex="-1"></a>    <span class="at">sex =</span> <span class="st">&quot;Sex&quot;</span>,</span>
<span id="cb45-12"><a href="#cb45-12" tabindex="-1"></a>    <span class="at">chocolate.ice.cream =</span> <span class="st">&quot;Consumed chocolate ice cream&quot;</span></span>
<span id="cb45-13"><a href="#cb45-13" tabindex="-1"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a>oswego <span class="sc">%&gt;%</span></span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>  <span class="fu">mhor</span>(ill <span class="sc">~</span> sex<span class="sc">/</span>chocolate.ice.cream)</span></code></pre></div>
<pre><code>
                                   OR Lower.CI Upper.CI Pr(&gt;|z|)
sexFemale:chocolate.ice.creamYes 0.47     0.11     2.06    0.318
sexMale:chocolate.ice.creamYes   0.24     0.05     1.13    0.072

                          Common OR Lower CI Upper CI Pr(&gt;|z|)
Cochran-Mantel-Haenszel:       0.35     0.12     1.01    0.085

Test for effect modification (interaction): p =  0.5434 
 </code></pre>
</div>
</div>
<div id="diagnostic-tests" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Diagnostic tests</h2>
<p>Example: We compare the use of lung’s X-rays on the screening of TB
against the gold standard test.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a>Freq <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1739</span>, <span class="dv">8</span>, <span class="dv">51</span>, <span class="dv">22</span>)</span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a>BCG <span class="ot">&lt;-</span> <span class="fu">gl</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Negative&quot;</span>, <span class="st">&quot;Positive&quot;</span>))</span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a>Xray <span class="ot">&lt;-</span> <span class="fu">gl</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Negative&quot;</span>, <span class="st">&quot;Positive&quot;</span>))</span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a>tb <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Freq, BCG, Xray)</span>
<span id="cb48-5"><a href="#cb48-5" tabindex="-1"></a>tb <span class="ot">&lt;-</span> <span class="fu">expand_df</span>(tb)</span>
<span id="cb48-6"><a href="#cb48-6" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" tabindex="-1"></a><span class="fu">diag_test</span>(BCG <span class="sc">~</span> Xray, <span class="at">data =</span> tb)</span></code></pre></div>
<pre><code>          Outcome +    Outcome -      Total
Test +           22           51         73
Test -            8         1739       1747
Total            30         1790       1820

Point estimates and 95% CIs:
--------------------------------------------------------------
Apparent prevalence *                  0.04 (0.03, 0.05)
True prevalence *                      0.02 (0.01, 0.02)
Sensitivity *                          0.73 (0.54, 0.88)
Specificity *                          0.97 (0.96, 0.98)
Positive predictive value *            0.30 (0.20, 0.42)
Negative predictive value *            1.00 (0.99, 1.00)
Positive likelihood ratio              25.74 (18.21, 36.38)
Negative likelihood ratio              0.27 (0.15, 0.50)
False T+ proportion for true D- *      0.03 (0.02, 0.04)
False T- proportion for true D+ *      0.27 (0.12, 0.46)
False T+ proportion for T+ *           0.70 (0.58, 0.80)
False T- proportion for T- *           0.00 (0.00, 0.01)
Correctly classified proportion *      0.97 (0.96, 0.98)
--------------------------------------------------------------
* Exact CIs</code></pre>
<p>Using the immediate version (direct input):</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="fu">diag_test2</span>(<span class="dv">22</span>, <span class="dv">51</span>, <span class="dv">8</span>, <span class="dv">1739</span>)</span></code></pre></div>
<pre><code>
          Outcome +    Outcome -      Total
Test +           22           51         73
Test -            8         1739       1747
Total            30         1790       1820

Point estimates and 95% CIs:
--------------------------------------------------------------
Apparent prevalence *                  0.04 (0.03, 0.05)
True prevalence *                      0.02 (0.01, 0.02)
Sensitivity *                          0.73 (0.54, 0.88)
Specificity *                          0.97 (0.96, 0.98)
Positive predictive value *            0.30 (0.20, 0.42)
Negative predictive value *            1.00 (0.99, 1.00)
Positive likelihood ratio              25.74 (18.21, 36.38)
Negative likelihood ratio              0.27 (0.15, 0.50)
False T+ proportion for true D- *      0.03 (0.02, 0.04)
False T- proportion for true D+ *      0.27 (0.12, 0.46)
False T+ proportion for T+ *           0.70 (0.58, 0.80)
False T- proportion for T- *           0.00 (0.00, 0.01)
Correctly classified proportion *      0.97 (0.96, 0.98)
--------------------------------------------------------------
* Exact CIs</code></pre>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
